import{_ as e,C as t,o as c,c as r,k as s,a as n,H as p,w as l,Q as o}from"./chunks/framework.6ed370c1.js";const y="/docs/assets/执行效果.16e94a40.png",E="/docs/assets/0.旋转90度.3581515e.png",i="/docs/assets/1.计算中心点.bf494c14.png",F="/docs/assets/2.位置调整.77f81562.png",u="/docs/assets/3.选择区域.ec5bf25f.png",C="/docs/assets/4.拟合平面.7a1e41d3.png",_="/docs/assets/5.裁切.d1c41fcc.png",d="/docs/assets/6.滤波.ecc9495d.png",P="/docs/assets/7.找中线.3f8606fc.png",b="/docs/assets/8.blob.08c28b56.png",B="/docs/assets/9.高度测量.14e87c23.png",Ss=JSON.parse('{"title":"196pin示例","description":"","frontmatter":{},"headers":[],"relativePath":"project/工程示例/196pin/196pin.md","filePath":"project/工程示例/196pin/196pin.md"}'),q={name:"project/工程示例/196pin/196pin.md"},D=o('<h1 id="_196pin示例" tabindex="-1">196pin示例 <a class="header-anchor" href="#_196pin示例" aria-label="Permalink to &quot;196pin示例&quot;">​</a></h1><h2 id="一、执行效果" tabindex="-1">一、执行效果 <a class="header-anchor" href="#一、执行效果" aria-label="Permalink to &quot;一、执行效果&quot;">​</a></h2><p><img src="'+y+'" alt="本地图片"><br></p><h2 id="二、初始化" tabindex="-1">二、初始化 <a class="header-anchor" href="#二、初始化" aria-label="Permalink to &quot;二、初始化&quot;">​</a></h2>',4),A=s("br",null,null,-1),x=s("br",null,null,-1),h=s("br",null,null,-1),m=s("br",null,null,-1),M=s("h2",{id:"三、左半部分处理",tabindex:"-1"},[n("三、左半部分处理 "),s("a",{class:"header-anchor",href:"#三、左半部分处理","aria-label":'Permalink to "三、左半部分处理"'},"​")],-1),S=s("h3",{id:"_1-图像定位",tabindex:"-1"},[n("1.图像定位 "),s("a",{class:"header-anchor",href:"#_1-图像定位","aria-label":'Permalink to "1.图像定位"'},"​")],-1),f=s("br",null,null,-1),g=s("img",{src:E,alt:"本地图片"},null,-1),z=s("br",null,null,-1),X=s("br",null,null,-1),H=s("br",null,null,-1),Y=s("img",{src:i,alt:"本地图片"},null,-1),L=s("br",null,null,-1),v=s("br",null,null,-1),V=s("img",{src:F,alt:"本地图片"},null,-1),G=s("br",null,null,-1),T=s("h3",{id:"_2-拟合平面",tabindex:"-1"},[n("2.拟合平面 "),s("a",{class:"header-anchor",href:"#_2-拟合平面","aria-label":'Permalink to "2.拟合平面"'},"​")],-1),k=s("br",null,null,-1),I=s("img",{src:u,alt:"本地图片"},null,-1),O=s("br",null,null,-1),N=s("br",null,null,-1),w=s("img",{src:C,alt:"本地图片"},null,-1),K=s("br",null,null,-1),J=s("h3",{id:"_3-裁切滤波",tabindex:"-1"},[n("3.裁切滤波 "),s("a",{class:"header-anchor",href:"#_3-裁切滤波","aria-label":'Permalink to "3.裁切滤波"'},"​")],-1),R=s("br",null,null,-1),$=s("img",{src:_,alt:"本地图片"},null,-1),j=s("br",null,null,-1),Q=s("br",null,null,-1),U=s("img",{src:d,alt:"本地图片"},null,-1),W=s("br",null,null,-1),Z=s("h3",{id:"_4-确定测量起点",tabindex:"-1"},[n("4.确定测量起点 "),s("a",{class:"header-anchor",href:"#_4-确定测量起点","aria-label":'Permalink to "4.确定测量起点"'},"​")],-1),ss=s("br",null,null,-1),ns=s("img",{src:P,alt:"本地图片"},null,-1),as=s("br",null,null,-1),ps=s("br",null,null,-1),ls=s("br",null,null,-1),os=s("img",{src:b,alt:"本地图片"},null,-1),es=s("br",null,null,-1),ts=s("h3",{id:"_5-循环测量每个pin",tabindex:"-1"},[n("5.循环测量每个pin "),s("a",{class:"header-anchor",href:"#_5-循环测量每个pin","aria-label":'Permalink to "5.循环测量每个pin"'},"​")],-1),cs=s("br",null,null,-1),rs=o(`<div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">--记录每行循环的起始点坐标</span></span>
<span class="line"><span style="color:#79B8FF;">SetVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;SmallpcbPinLoop&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">smallPcbColumn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetIntVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;SmallPcbColumn&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(smallPcbColumn)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">x, y, z </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetPoint</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;PCB_Start&#39; </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> (smallPcbColumn </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">SetPoint</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;SmallpcbColumnStart&#39;</span><span style="color:#E1E4E8;">, x, y, z)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;SmallpcbColumnStart = &#39;</span><span style="color:#E1E4E8;">, x, y, z)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">--记录每行循环的起始点坐标</span></span>
<span class="line"><span style="color:#005CC5;">SetVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;SmallpcbPinLoop&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">smallPcbColumn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetIntVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;SmallPcbColumn&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(smallPcbColumn)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">x, y, z </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetPoint</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;PCB_Start&#39; </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> (smallPcbColumn </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">SetPoint</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;SmallpcbColumnStart&#39;</span><span style="color:#24292E;">, x, y, z)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;SmallpcbColumnStart = &#39;</span><span style="color:#24292E;">, x, y, z)</span></span></code></pre></div>`,1),ys=s("br",null,null,-1),Es=o(`<div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">--设置每个pin脚的blob坐标，创建box</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsx1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsy1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsz1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinex1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_piney1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinez1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsx2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsy2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsz2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinex2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_piney2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinez2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--先获取一些变量，等待使用</span></span>
<span class="line"><span style="color:#E1E4E8;">cs_x, cs_y, cs_z </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetPoint</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;SmallpcbColumnStart&#39;</span><span style="color:#E1E4E8;">)      </span><span style="color:#6A737D;">--起始点</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(cs_x, cs_y, cs_z)</span></span>
<span class="line"><span style="color:#E1E4E8;">smallpcbPinLoop </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetIntVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;SmallpcbPinLoop&#39;</span><span style="color:#E1E4E8;">)            </span><span style="color:#6A737D;">--循环次数</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;smallpcbPinLoop =&quot;</span><span style="color:#E1E4E8;">, smallpcbPinLoop)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--前5列和后面列的间隔不同，分开处理</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (smallpcbPinLoop </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinsx </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> smallpcbPinLoop </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.4</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinex </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> smallpcbPinLoop </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.4</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinsx1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> pcb_pinsx</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinex1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> pcb_pinex</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (smallpcbPinLoop </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">        pcb_pinsx2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> smallpcbPinLoop  </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.4</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2.5</span></span>
<span class="line"><span style="color:#E1E4E8;">        pcb_pinex2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> smallpcbPinLoop  </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.4</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2.5</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">else</span></span>
<span class="line"><span style="color:#E1E4E8;">        pcb_pinsx2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> (smallpcbPinLoop </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.4</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"><span style="color:#E1E4E8;">        pcb_pinex2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> (smallpcbPinLoop </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.4</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">end</span></span>
<span class="line"><span style="color:#F97583;">else</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinsx </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> smallpcbPinLoop </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.6</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinex </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> smallpcbPinLoop </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.6</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinsx1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> pcb_pinsx</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinex1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> pcb_pinex</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinsx2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> (smallpcbPinLoop </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.6</span></span>
<span class="line"><span style="color:#E1E4E8;">    pcb_pinex2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> (smallpcbPinLoop </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.6</span></span>
<span class="line"><span style="color:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsy </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_y </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_piney </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_y </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsz </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_z </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.7</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinez </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_z </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsy1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_y </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_piney1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_y </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsz1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_z </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinez1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_z </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsy2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_y </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.9</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_piney2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_y </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.9</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinsz2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_z </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.6</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_pinez2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> cs_z </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.9</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(pcb_pinsx1, pcb_pinsy1, pcb_pinsz1)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(pcb_pinsx2, pcb_pinsy2, pcb_pinsz2)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">PushBox</span><span style="color:#E1E4E8;">(pcb_pinsx1, pcb_pinsy1, pcb_pinsz1, pcb_pinex1, pcb_piney1, pcb_pinez1)</span></span>
<span class="line"><span style="color:#79B8FF;">PushBox</span><span style="color:#E1E4E8;">(pcb_pinsx2, pcb_pinsy2, pcb_pinsz2, pcb_pinex2, pcb_piney2, pcb_pinez2)</span></span>
<span class="line"><span style="color:#79B8FF;">DrawBox</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, pcb_pinsx1, pcb_pinsy1, pcb_pinsz1, pcb_pinex1, pcb_piney1, pcb_pinez1)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">--设置每个pin脚的blob坐标，创建box</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinsx1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinsy1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinsz1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinex1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_piney1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinez1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinsx2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinsy2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinsz2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinex2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_piney2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinez2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--先获取一些变量，等待使用</span></span>
<span class="line"><span style="color:#24292E;">cs_x, cs_y, cs_z </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetPoint</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;SmallpcbColumnStart&#39;</span><span style="color:#24292E;">)      </span><span style="color:#6A737D;">--起始点</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(cs_x, cs_y, cs_z)</span></span>
<span class="line"><span style="color:#24292E;">smallpcbPinLoop </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetIntVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;SmallpcbPinLoop&#39;</span><span style="color:#24292E;">)            </span><span style="color:#6A737D;">--循环次数</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;smallpcbPinLoop =&quot;</span><span style="color:#24292E;">, smallpcbPinLoop)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--前5列和后面列的间隔不同，分开处理</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (smallpcbPinLoop </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinsx </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> smallpcbPinLoop </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.4</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinex </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> smallpcbPinLoop </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.4</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinsx1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pcb_pinsx</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinex1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pcb_pinex</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (smallpcbPinLoop </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">        pcb_pinsx2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> smallpcbPinLoop  </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.4</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2.5</span></span>
<span class="line"><span style="color:#24292E;">        pcb_pinex2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> smallpcbPinLoop  </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.4</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2.5</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">else</span></span>
<span class="line"><span style="color:#24292E;">        pcb_pinsx2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> (smallpcbPinLoop </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.4</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#24292E;">        pcb_pinex2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> (smallpcbPinLoop </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.4</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">end</span></span>
<span class="line"><span style="color:#D73A49;">else</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinsx </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> smallpcbPinLoop </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.6</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinex </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> smallpcbPinLoop </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.6</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinsx1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pcb_pinsx</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinex1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pcb_pinex</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinsx2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> (smallpcbPinLoop </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.6</span></span>
<span class="line"><span style="color:#24292E;">    pcb_pinex2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> (smallpcbPinLoop </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.6</span></span>
<span class="line"><span style="color:#D73A49;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">pcb_pinsy </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_y </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#24292E;">pcb_piney </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_y </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinsz </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_z </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.7</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinez </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_z </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">pcb_pinsy1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_y </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#24292E;">pcb_piney1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_y </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinsz1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_z </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinez1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_z </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">pcb_pinsy2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_y </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.9</span></span>
<span class="line"><span style="color:#24292E;">pcb_piney2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_y </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.9</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinsz2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_z </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.6</span></span>
<span class="line"><span style="color:#24292E;">pcb_pinez2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cs_z </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.9</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(pcb_pinsx1, pcb_pinsy1, pcb_pinsz1)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(pcb_pinsx2, pcb_pinsy2, pcb_pinsz2)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">PushBox</span><span style="color:#24292E;">(pcb_pinsx1, pcb_pinsy1, pcb_pinsz1, pcb_pinex1, pcb_piney1, pcb_pinez1)</span></span>
<span class="line"><span style="color:#005CC5;">PushBox</span><span style="color:#24292E;">(pcb_pinsx2, pcb_pinsy2, pcb_pinsz2, pcb_pinex2, pcb_piney2, pcb_pinez2)</span></span>
<span class="line"><span style="color:#005CC5;">DrawBox</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, pcb_pinsx1, pcb_pinsy1, pcb_pinsz1, pcb_pinex1, pcb_piney1, pcb_pinez1)</span></span></code></pre></div>`,1),is=s("br",null,null,-1),Fs=s("img",{src:B,alt:"本地图片"},null,-1),us=s("br",null,null,-1),Cs=s("br",null,null,-1),_s=s("br",null,null,-1),ds=o(`<div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">--结果判断</span></span>
<span class="line"><span style="color:#6A737D;">--取出当前循环的针数，从配方中取出响应的值，初始化</span></span>
<span class="line"><span style="color:#E1E4E8;">pinCount </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetIntVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;PcbCurPin&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">currentPin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetRecipe</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;196MAT&quot;</span><span style="color:#E1E4E8;">, pinCount)</span></span>
<span class="line"><span style="color:#E1E4E8;">pinCount </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> pinCount </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">--后面处理都按照1起始的，全局保存按照0起始的，这里要加1</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinCount =&quot;</span><span style="color:#E1E4E8;">, pinCount)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">pinPositionXMax </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionXMax</span></span>
<span class="line"><span style="color:#E1E4E8;">pinPositionXMin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionXMin</span></span>
<span class="line"><span style="color:#E1E4E8;">pinPositionYMax </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionY</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionYMax</span></span>
<span class="line"><span style="color:#E1E4E8;">pinPositionYMin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionY</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionYMin</span></span>
<span class="line"><span style="color:#E1E4E8;">pinHightMax </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinHight</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinHightMax</span></span>
<span class="line"><span style="color:#E1E4E8;">pinHightMin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinHight</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinHightMin</span></span>
<span class="line"><span style="color:#E1E4E8;">pinSideXMax </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideXMax</span></span>
<span class="line"><span style="color:#E1E4E8;">pinSideXMin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideXMin</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;sidexmax&quot;</span><span style="color:#E1E4E8;">, pinSideXMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;sidex1&quot;</span><span style="color:#E1E4E8;">, currentPin.</span><span style="color:#B392F0;">PinSideX</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;sidexmmm&quot;</span><span style="color:#E1E4E8;">, currentPin.</span><span style="color:#B392F0;">PinSideXMax</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;sidexmin&quot;</span><span style="color:#E1E4E8;">, pinSideXMin)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;sidex2&quot;</span><span style="color:#E1E4E8;">, currentPin.</span><span style="color:#B392F0;">PinSideX</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;sidexmin&quot;</span><span style="color:#E1E4E8;">, currentPin.</span><span style="color:#B392F0;">PinSideXMin</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">pinSideXMin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideXMin</span></span>
<span class="line"><span style="color:#E1E4E8;">pinSideYMax </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideY</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideYMax</span></span>
<span class="line"><span style="color:#E1E4E8;">pinSideYMin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideY</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideYMin</span></span>
<span class="line"><span style="color:#E1E4E8;">pinSideHightMax </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideHight</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideHightMax</span></span>
<span class="line"><span style="color:#E1E4E8;">pinSideHightMin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideHight</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinSideHightMin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinPositionXMax&quot;</span><span style="color:#E1E4E8;">, pinPositionXMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinPositionXMin&quot;</span><span style="color:#E1E4E8;">, pinPositionXMin)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinPositionYMax&quot;</span><span style="color:#E1E4E8;">, pinPositionYMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinPositionYMin&quot;</span><span style="color:#E1E4E8;">, pinPositionYMin)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinHightMax&quot;</span><span style="color:#E1E4E8;">, pinHightMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinHightMin&quot;</span><span style="color:#E1E4E8;">, pinHightMin)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideXMax&quot;</span><span style="color:#E1E4E8;">, pinSideXMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideXMin&quot;</span><span style="color:#E1E4E8;">, pinSideXMin)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideYMax&quot;</span><span style="color:#E1E4E8;">, pinSideYMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideYMin&quot;</span><span style="color:#E1E4E8;">, pinSideYMin)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideHightMax&quot;</span><span style="color:#E1E4E8;">, pinSideHightMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideHightMin&quot;</span><span style="color:#E1E4E8;">, pinSideHightMin)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--获取当前针的高度、位置值</span></span>
<span class="line"><span style="color:#E1E4E8;">pcb_ValH </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetMeasure</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">Value_H </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> pcb_ValH </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinHightSupply</span></span>
<span class="line"><span style="color:#E1E4E8;">x, y, z </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetPoint</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">x1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">math.abs</span><span style="color:#E1E4E8;">(x) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionXSupply</span></span>
<span class="line"><span style="color:#E1E4E8;">y1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">math.abs</span><span style="color:#E1E4E8;">(y) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> currentPin.</span><span style="color:#B392F0;">PinPositionYSupply</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--写文件</span></span>
<span class="line"><span style="color:#79B8FF;">fprint</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;D:</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">dates</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">aiv</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">value_x.csv&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">string.format</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;%f,&quot;</span><span style="color:#E1E4E8;">, x))</span></span>
<span class="line"><span style="color:#79B8FF;">fprint</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;D:</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">dates</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">aiv</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">value_y.csv&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">string.format</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;%f,&quot;</span><span style="color:#E1E4E8;">, y))</span></span>
<span class="line"><span style="color:#79B8FF;">fprint</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;D:</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">dates</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">aiv</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">value_z.csv&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">string.format</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;%f,&quot;</span><span style="color:#E1E4E8;">, z))</span></span>
<span class="line"><span style="color:#79B8FF;">fprint</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;D:</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">dates</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">aiv</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">value_h.csv&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">string.format</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;%f,&quot;</span><span style="color:#E1E4E8;">, Value_H))</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Value_H &lt; pinHightMax&quot;</span><span style="color:#E1E4E8;">, Value_H </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> pinHightMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Value_H &gt; pinHightMin&quot;</span><span style="color:#E1E4E8;">, Value_H </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> pinHightMin)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;x1 &lt; pinPositionXMax&quot;</span><span style="color:#E1E4E8;">, x1 </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> pinPositionXMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;x1 &gt; pinPositionXMin&quot;</span><span style="color:#E1E4E8;">, x1 </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> pinPositionXMin)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;y1 &lt; pinPositionYMax&quot;</span><span style="color:#E1E4E8;">, y1 </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> pinPositionYMax)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;y1 &gt; pinPositionYMin&quot;</span><span style="color:#E1E4E8;">, y1 </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> pinPositionYMin)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;x1&quot;</span><span style="color:#E1E4E8;">, x1)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;y1&quot;</span><span style="color:#E1E4E8;">, y1)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;z&quot;</span><span style="color:#E1E4E8;">, z)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--判断值是否在OK范围内</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> Value_H </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> pinHightMax </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> Value_H </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> pinHightMin                                     </span><span style="color:#6A737D;">--高度比较</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> x1 </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> pinPositionXMax </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> x1 </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> pinPositionXMin                                  </span><span style="color:#6A737D;">--x比较</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> y1 </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> pinPositionYMax </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> y1 </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> pinPositionYMin                                  </span><span style="color:#6A737D;">--y比较</span></span>
<span class="line"><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Pin&quot; </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> pinCount </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; :OK&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">DrawOverlay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, x, y, z, </span><span style="color:#79B8FF;">12</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;#00ff00&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;Pin&quot; </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> pinCount </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; :OK&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">else</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Pin&quot; </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> pinCount </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; :NG&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">DrawOverlay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, x, y, z, </span><span style="color:#79B8FF;">12</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;#ff0000&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;Pin&quot; </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> pinCount </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; :NG&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--TODO 结果保存到全局</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;das&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">GetIntVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;SmallpcbPinLoop&quot;</span><span style="color:#E1E4E8;">))</span></span>
<span class="line"><span style="color:#6A737D;">--判断side是否在ok范围内</span></span>
<span class="line"><span style="color:#E1E4E8;">smallpcbPinLoop </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetIntVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;SmallpcbPinLoop&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> smallpcbPinLoop </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">    x2, y2, z2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetPoint</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">elseif</span><span style="color:#E1E4E8;"> smallpcbPinLoop </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">    x2, y2, z2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetPoint</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">7</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">end</span></span>
<span class="line"><span style="color:#E1E4E8;">reduceresultx </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">math.abs</span><span style="color:#E1E4E8;">(x2 </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> x)</span></span>
<span class="line"><span style="color:#E1E4E8;">reduceresulty </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">math.abs</span><span style="color:#E1E4E8;">(y2 </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> y)</span></span>
<span class="line"><span style="color:#E1E4E8;">reduceresultz </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">math.abs</span><span style="color:#E1E4E8;">(z2 </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> z)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;x2&quot;</span><span style="color:#E1E4E8;">, x2)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;y2&quot;</span><span style="color:#E1E4E8;">, y2)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;z2&quot;</span><span style="color:#E1E4E8;">, z2)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideXMax&quot;</span><span style="color:#E1E4E8;">, reduceresultx)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideXMin&quot;</span><span style="color:#E1E4E8;">, reduceresulty)</span></span>
<span class="line"><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideYMax&quot;</span><span style="color:#E1E4E8;">, reduceresultz)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> reduceresultx </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> pinSideXMax </span><span style="color:#F97583;">or</span><span style="color:#E1E4E8;"> reduceresultx </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> pinSideXMin</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">or</span><span style="color:#E1E4E8;"> reduceresulty </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> pinSideYMax </span><span style="color:#F97583;">or</span><span style="color:#E1E4E8;"> reduceresulty </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> pinSideYMin</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">or</span><span style="color:#E1E4E8;"> reduceresultz </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> pinSideHightMax </span><span style="color:#F97583;">or</span><span style="color:#E1E4E8;"> reduceresultz </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> pinSideHightMin</span></span>
<span class="line"><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Pin&quot; </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> pinCount </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; Side :NG&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pinSideYMax&quot;</span><span style="color:#E1E4E8;">, reduceresultx)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">DrawOverlay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, x, y </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span><span style="color:#E1E4E8;">, z, </span><span style="color:#79B8FF;">12</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;#ff0000&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;Side :NG&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">else</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">println</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Pin&quot; </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> pinCount </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; Side :OK&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">DrawOverlay</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, x, y </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.5</span><span style="color:#E1E4E8;">, z, </span><span style="color:#79B8FF;">12</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;#00ff00&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;Side :OK&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--保存当前循环的针数</span></span>
<span class="line"><span style="color:#79B8FF;">SetVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;PcbCurPin&quot;</span><span style="color:#E1E4E8;">, pinCount)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">--结果判断</span></span>
<span class="line"><span style="color:#6A737D;">--取出当前循环的针数，从配方中取出响应的值，初始化</span></span>
<span class="line"><span style="color:#24292E;">pinCount </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetIntVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;PcbCurPin&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">currentPin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetRecipe</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;196MAT&quot;</span><span style="color:#24292E;">, pinCount)</span></span>
<span class="line"><span style="color:#24292E;">pinCount </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pinCount </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">--后面处理都按照1起始的，全局保存按照0起始的，这里要加1</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinCount =&quot;</span><span style="color:#24292E;">, pinCount)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">pinPositionXMax </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionXMax</span></span>
<span class="line"><span style="color:#24292E;">pinPositionXMin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionXMin</span></span>
<span class="line"><span style="color:#24292E;">pinPositionYMax </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionY</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionYMax</span></span>
<span class="line"><span style="color:#24292E;">pinPositionYMin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionY</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionYMin</span></span>
<span class="line"><span style="color:#24292E;">pinHightMax </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinHight</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinHightMax</span></span>
<span class="line"><span style="color:#24292E;">pinHightMin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinHight</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinHightMin</span></span>
<span class="line"><span style="color:#24292E;">pinSideXMax </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideXMax</span></span>
<span class="line"><span style="color:#24292E;">pinSideXMin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideXMin</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;sidexmax&quot;</span><span style="color:#24292E;">, pinSideXMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;sidex1&quot;</span><span style="color:#24292E;">, currentPin.</span><span style="color:#6F42C1;">PinSideX</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;sidexmmm&quot;</span><span style="color:#24292E;">, currentPin.</span><span style="color:#6F42C1;">PinSideXMax</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;sidexmin&quot;</span><span style="color:#24292E;">, pinSideXMin)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;sidex2&quot;</span><span style="color:#24292E;">, currentPin.</span><span style="color:#6F42C1;">PinSideX</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;sidexmin&quot;</span><span style="color:#24292E;">, currentPin.</span><span style="color:#6F42C1;">PinSideXMin</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">pinSideXMin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideXMin</span></span>
<span class="line"><span style="color:#24292E;">pinSideYMax </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideY</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideYMax</span></span>
<span class="line"><span style="color:#24292E;">pinSideYMin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideY</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideYMin</span></span>
<span class="line"><span style="color:#24292E;">pinSideHightMax </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideHight</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideHightMax</span></span>
<span class="line"><span style="color:#24292E;">pinSideHightMin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideHight</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinSideHightMin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinPositionXMax&quot;</span><span style="color:#24292E;">, pinPositionXMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinPositionXMin&quot;</span><span style="color:#24292E;">, pinPositionXMin)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinPositionYMax&quot;</span><span style="color:#24292E;">, pinPositionYMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinPositionYMin&quot;</span><span style="color:#24292E;">, pinPositionYMin)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinHightMax&quot;</span><span style="color:#24292E;">, pinHightMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinHightMin&quot;</span><span style="color:#24292E;">, pinHightMin)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideXMax&quot;</span><span style="color:#24292E;">, pinSideXMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideXMin&quot;</span><span style="color:#24292E;">, pinSideXMin)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideYMax&quot;</span><span style="color:#24292E;">, pinSideYMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideYMin&quot;</span><span style="color:#24292E;">, pinSideYMin)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideHightMax&quot;</span><span style="color:#24292E;">, pinSideHightMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideHightMin&quot;</span><span style="color:#24292E;">, pinSideHightMin)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--获取当前针的高度、位置值</span></span>
<span class="line"><span style="color:#24292E;">pcb_ValH </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetMeasure</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">4</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">Value_H </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pcb_ValH </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinHightSupply</span></span>
<span class="line"><span style="color:#24292E;">x, y, z </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetPoint</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">x1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">math.abs</span><span style="color:#24292E;">(x) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionXSupply</span></span>
<span class="line"><span style="color:#24292E;">y1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">math.abs</span><span style="color:#24292E;">(y) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> currentPin.</span><span style="color:#6F42C1;">PinPositionYSupply</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--写文件</span></span>
<span class="line"><span style="color:#005CC5;">fprint</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;D:</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">dates</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">aiv</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">value_x.csv&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">string.format</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;%f,&quot;</span><span style="color:#24292E;">, x))</span></span>
<span class="line"><span style="color:#005CC5;">fprint</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;D:</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">dates</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">aiv</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">value_y.csv&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">string.format</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;%f,&quot;</span><span style="color:#24292E;">, y))</span></span>
<span class="line"><span style="color:#005CC5;">fprint</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;D:</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">dates</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">aiv</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">value_z.csv&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">string.format</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;%f,&quot;</span><span style="color:#24292E;">, z))</span></span>
<span class="line"><span style="color:#005CC5;">fprint</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;D:</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">dates</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">aiv</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">value_h.csv&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">string.format</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;%f,&quot;</span><span style="color:#24292E;">, Value_H))</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Value_H &lt; pinHightMax&quot;</span><span style="color:#24292E;">, Value_H </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> pinHightMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Value_H &gt; pinHightMin&quot;</span><span style="color:#24292E;">, Value_H </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> pinHightMin)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;x1 &lt; pinPositionXMax&quot;</span><span style="color:#24292E;">, x1 </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> pinPositionXMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;x1 &gt; pinPositionXMin&quot;</span><span style="color:#24292E;">, x1 </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> pinPositionXMin)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;y1 &lt; pinPositionYMax&quot;</span><span style="color:#24292E;">, y1 </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> pinPositionYMax)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;y1 &gt; pinPositionYMin&quot;</span><span style="color:#24292E;">, y1 </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> pinPositionYMin)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;x1&quot;</span><span style="color:#24292E;">, x1)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;y1&quot;</span><span style="color:#24292E;">, y1)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;z&quot;</span><span style="color:#24292E;">, z)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--判断值是否在OK范围内</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> Value_H </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> pinHightMax </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> Value_H </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> pinHightMin                                     </span><span style="color:#6A737D;">--高度比较</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> x1 </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> pinPositionXMax </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> x1 </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> pinPositionXMin                                  </span><span style="color:#6A737D;">--x比较</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> y1 </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> pinPositionYMax </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> y1 </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> pinPositionYMin                                  </span><span style="color:#6A737D;">--y比较</span></span>
<span class="line"><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Pin&quot; </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> pinCount </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; :OK&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">DrawOverlay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, x, y, z, </span><span style="color:#005CC5;">12</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;#00ff00&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;Pin&quot; </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> pinCount </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; :OK&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">else</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Pin&quot; </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> pinCount </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; :NG&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">DrawOverlay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, x, y, z, </span><span style="color:#005CC5;">12</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;#ff0000&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;Pin&quot; </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> pinCount </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; :NG&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">end</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--TODO 结果保存到全局</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;das&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">GetIntVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;SmallpcbPinLoop&quot;</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#6A737D;">--判断side是否在ok范围内</span></span>
<span class="line"><span style="color:#24292E;">smallpcbPinLoop </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetIntVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;SmallpcbPinLoop&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> smallpcbPinLoop </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">20</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">    x2, y2, z2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetPoint</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">elseif</span><span style="color:#24292E;"> smallpcbPinLoop </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">20</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">    x2, y2, z2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetPoint</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">7</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">end</span></span>
<span class="line"><span style="color:#24292E;">reduceresultx </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">math.abs</span><span style="color:#24292E;">(x2 </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> x)</span></span>
<span class="line"><span style="color:#24292E;">reduceresulty </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">math.abs</span><span style="color:#24292E;">(y2 </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> y)</span></span>
<span class="line"><span style="color:#24292E;">reduceresultz </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">math.abs</span><span style="color:#24292E;">(z2 </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> z)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;x2&quot;</span><span style="color:#24292E;">, x2)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;y2&quot;</span><span style="color:#24292E;">, y2)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;z2&quot;</span><span style="color:#24292E;">, z2)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideXMax&quot;</span><span style="color:#24292E;">, reduceresultx)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideXMin&quot;</span><span style="color:#24292E;">, reduceresulty)</span></span>
<span class="line"><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideYMax&quot;</span><span style="color:#24292E;">, reduceresultz)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> reduceresultx </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> pinSideXMax </span><span style="color:#D73A49;">or</span><span style="color:#24292E;"> reduceresultx </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> pinSideXMin</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">or</span><span style="color:#24292E;"> reduceresulty </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> pinSideYMax </span><span style="color:#D73A49;">or</span><span style="color:#24292E;"> reduceresulty </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> pinSideYMin</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">or</span><span style="color:#24292E;"> reduceresultz </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> pinSideHightMax </span><span style="color:#D73A49;">or</span><span style="color:#24292E;"> reduceresultz </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> pinSideHightMin</span></span>
<span class="line"><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Pin&quot; </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> pinCount </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; Side :NG&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pinSideYMax&quot;</span><span style="color:#24292E;">, reduceresultx)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">DrawOverlay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, x, y </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;">, z, </span><span style="color:#005CC5;">12</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;#ff0000&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;Side :NG&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">else</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Pin&quot; </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> pinCount </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; Side :OK&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">DrawOverlay</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, x, y </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;">, z, </span><span style="color:#005CC5;">12</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;#00ff00&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;Side :OK&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">--保存当前循环的针数</span></span>
<span class="line"><span style="color:#005CC5;">SetVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;PcbCurPin&quot;</span><span style="color:#24292E;">, pinCount)</span></span></code></pre></div>`,1),Ps=s("br",null,null,-1),bs=o(`<div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">--判断循环次数</span></span>
<span class="line"><span style="color:#E1E4E8;">smallpcbPinLoop </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetIntVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;SmallpcbPinLoop&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#79B8FF;">SetVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;SmallpcbPinLoop&quot;</span><span style="color:#E1E4E8;">, smallpcbPinLoop)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> smallpcbPinLoop </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">21</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">    smallPcbColumn </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">GetIntVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;SmallPcbColumn&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">SetVariable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;SmallPcbColumn&quot;</span><span style="color:#E1E4E8;">, smallPcbColumn)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> smallPcbColumn </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">Jump</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;loop Column&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">else</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">Jump</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;None&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">end</span></span>
<span class="line"><span style="color:#F97583;">elseif</span><span style="color:#E1E4E8;"> smallpcbPinLoop </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">21</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Jump</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;loop pin&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">end</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">--判断循环次数</span></span>
<span class="line"><span style="color:#24292E;">smallpcbPinLoop </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetIntVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;SmallpcbPinLoop&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#005CC5;">SetVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;SmallpcbPinLoop&quot;</span><span style="color:#24292E;">, smallpcbPinLoop)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> smallpcbPinLoop </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">21</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">    smallPcbColumn </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">GetIntVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;SmallPcbColumn&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">SetVariable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;SmallPcbColumn&quot;</span><span style="color:#24292E;">, smallPcbColumn)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> smallPcbColumn </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">Jump</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;loop Column&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">else</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">Jump</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;None&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">end</span></span>
<span class="line"><span style="color:#D73A49;">elseif</span><span style="color:#24292E;"> smallpcbPinLoop </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">21</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Jump</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;loop pin&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">end</span></span></code></pre></div><h2 id="四、右半部分处理" tabindex="-1">四、右半部分处理 <a class="header-anchor" href="#四、右半部分处理" aria-label="Permalink to &quot;四、右半部分处理&quot;">​</a></h2><p>此部分处理逻辑和有半部分的一模一样，请参考上一节的流程。</p>`,3);function Bs(qs,Ds,As,xs,hs,ms){const a=t("font");return c(),r("div",null,[D,s("p",null,[n("[00]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("Lua脚本语言")]),_:1}),n("工具，读取项目的配方文件。"),A,n(" [01]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("Lua脚本语言")]),_:1}),n("工具，全局变量初始化。"),x,n(" [02]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("加载点云")]),_:1}),n("工具，获取点云"),h,n(" [03]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D裁切预处理")]),_:1}),n("工具，将点云复制一份到IM1（IM0不动后面可以再次使用）。"),m]),M,S,s("p",null,[n("[04]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D变换预处理")]),_:1}),n("工具，将点云进行90度的旋转"),f,g,z]),s("p",null,[n("[05-08]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D方形探针")]),_:1}),n("工具，选择4个边界的pin针，输出其中心点的坐标"),X]),s("p",null,[n("[09]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("Lua语言脚本")]),_:1}),n("工具，计算出4个点的x和y坐标的平均值，作为左半部分的中心点"),H,Y,L]),s("p",null,[n("[10]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D位置调整")]),_:1}),n("工具，选择上1步计算出来的中心点为原点，调整点云的X和Y位置"),v,V,G]),T,s("p",null,[n("[11]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("区域")]),_:1}),n("工具，选择左半部分底面比较平坦的区域，合并成一个区域"),k,I,O]),s("p",null,[n("[12]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D平面")]),_:1}),n("工具，选择上1步计算出的区域，拟合平面"),N,w,K]),J,s("p",null,[n("[13]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D裁切预处理")]),_:1}),n("工具，选择要进行测量的pin的区域，并输出到新的IM2中进行处理"),R,$,j]),s("p",null,[n("[14]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D离群点滤波")]),_:1}),n("工具，去除pin周围的一切干扰噪点"),Q,U,W]),Z,s("p",null,[n("[15]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D方形探针")]),_:1}),n("工具，选择pin最中间一行，根据所有pin生成一条直线"),ss,ns,as]),s("p",null,[n("[16]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D位置调整")]),_:1}),n("工具，选择上1步输出的直线，调整点云X和Y的位置"),ps]),s("p",null,[n("[17]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D斑点")]),_:1}),n("工具，选择pin的最左边一列作为起始列，找出每一行的第一个点"),ls,os,es]),ts,s("p",null,[n("[18-21]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("标记")]),_:1}),n("工具，记录每一行和每一列的循环标记，并通过脚本获取每一行的起始点坐标"),cs]),rs,s("p",null,[n("[22]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("Lua语言脚本")]),_:1}),n("工具，根据每个pin的位置，计算出对应的Box大小，并绘制在IM2窗口中"),ys]),Es,s("p",null,[n("[23]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D高度")]),_:1}),n("工具，选择上1步脚本中创建的box(寄存器中选择)，对该pin的高度进行测量"),is,Fs,us]),s("p",null,[n("[24-25]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("3D方形探针")]),_:1}),n("工具，选择第22步脚本中创建的box(寄存器中选择)，对该pin的位置进行测量，输出pin的位置坐标"),Cs]),s("p",null,[n("[26]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("Lua语言脚本")]),_:1}),n("工具，将前3步输出的位置和高度信息进行判断，并保存到文件中"),_s]),ds,s("p",null,[n("[27]选择"),p(a,{color:"#00ff00"},{default:l(()=>[n("Lua语言脚本")]),_:1}),n("工具，循环次数判断，一列结束时，跳转到下一列，所有列都结束后，跳转到None标记，代表此半边pin检测完成"),Ps]),bs])}const fs=e(q,[["render",Bs]]);export{Ss as __pageData,fs as default};
